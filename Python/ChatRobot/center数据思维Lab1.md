# <center>数据思维Lab1 ChatBot</center>

### Basic：

#### Task1：

首先对于Task1，可以采用修改父类Bot的`Run()`函数，增加一个循环条件分支来实现。虽然之前没有使用过OOP的编程思想，但我认为这种方法不太好，父类和子类关系应该是父类越兼容并包越好，如果把其中一个子类的情况加到父类中，会使得父类显得冗杂。所以我选择在子类`CalcBot`中重载`run()`函数。具体实现代码见.py文件。

#### Task2：

##### 功能：

实现了一个天气预报机器人。

##### 实现方法：

思路：使用天气网api接口。

1.引入 `request`包。

2.定义Bot的一个新子类WeatherBot。

3.重写 `think` 函数。由于天气网可以返回多个数值，用的是字典的形式，按照之前的方式用父类的 `run()` 打印不太方便。但是我不想再重写 `run()`函数。这会使得代码变得冗长。于是直接在 `think`函数中打印我们要的结果即可。最后返回一句预报成功的提示。 

##### Note：

注意：天气网api接收多个参数，理论上来说用一个数组接收并使用是最合理的。这里为了方便，我只取了一个参数：城市。所以在使用该功能时候，请输入城市名即可。如果输入多个参数或者输入参数不合理，可能会导致城市读取失败。

GOOD 字符串匹配问题。 异常处理。

good等的优化。

天气机器人。

### Optimization：

#### Case1：wait()的优化

我们实现的5个机器人功能中（打招呼&问候&颜色&天气预报&计算）。显然除了最后一个计算功能，其他四个功能都相对容易回答。那么原定程序的1s等待时间已经显得非常合适了。但是对于计算，我们知道计算时间应该和问题规模成正比才合理。

这里不考虑数据的偶然性如 ：
$$
1e1000 * 1e1000 = 1e2000
$$
只考虑数据的规模，也就是我们的result的规模。

假定和我们对话的是一位”神童“或智能机器人，它每秒可以算出1e20规模的值。

简单定义一个函数来算出计算延时：

<img src="C:\Users\wwwxi\AppData\Roaming\Typora\typora-user-images\image-20200411220023684.png" alt="image-20200411220023684" style="zoom: 50%;" />

之后在CalcBot的run函数里区分好Bot.wait和self.wait即可。



#### Case2：异常处理

关于异常处理其实也很复杂，要考虑多种输出异常的情况并分别作出反应。

我这里也作出简化，只考虑2种：

- 计算机器人中的除以0情况。处理也很简单，直接用python内置的异常处理，try抛出异常并打印信息即可。注意：一旦出现这种情况，我设定的回应是不给答案，提示重新输入。

- 初始时输入的是空串的情况。如：现在面对问候机器人，它在等待我们键入心情状态。此时不小心键入一个空串，根据我们的程序，它也会认为我们心情不好，从而提示”sorry to hear that ……“，这是不合理的。所以简单处理：如果输入的是空串则提示重输直到不是空串即可。

  

#### Case3：Isgood()函数的优化

当时老师在讲这个问候机器人的时候，确实很明显感觉到我们原来的isgood函数问题很多。思考下大致有几点：

1. 词量过少。首先用户键入的可能不只是正面词汇，也可能是负面词汇如’bad‘，’uneasy‘，’weary’等等。即便是正面词汇也不只是‘good’，这里最优的方式应该是使用情绪词表，结合程度词表，使用一定的算法对句子进行打分，从而得出是正面情感还是负面情感。但实现复杂，于是简单处理加了几个正面词汇。
2. 无法判断否定句。这一类情况是如：'not good'，加上否定词以后情感刚好相反了，这里处理较为简单，简化处理，我假定只有'not'一种否定词，如果有not出现，就把bool类型的返回值刚好取反即可。
3. 叠词的情况。这一类情况是如‘goood’或‘goodd’，基本上可以肯定用户的原意就是‘good‘，但由于我们程序设置的缺陷，只要数组中没有出现，就会认为是完全相反的情况。这里可以考虑用字符串匹配来作处理从而提升用户体验。



### Final：

本地运行截图如下：

<img src="C:\Users\wwwxi\AppData\Roaming\Typora\typora-user-images\image-20200411222203591.png" alt="image-20200411222203591" style="zoom: 33%;" />



 																										     **Thanks for reading！**

​                                                                                                                   姓名：黄震

​                                                                                                                   学号：10175102153